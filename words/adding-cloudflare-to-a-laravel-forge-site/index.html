<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="referrer" content="always">
    <link rel="canonical" href="https://imacrayon.com/words/adding-cloudflare-to-a-laravel-forge-site">

    <title>Adding Cloudflare to a Laravel Forge Site | I&#039;m a crayon</title>
    <meta name="description" content="The steps I took to put Cloudflare in front of a website managed on Laravel Forge">

    <link rel="icon" href="/favicon.svg">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#AA8C2C">

    <meta property="og:title" content="Adding Cloudflare to a Laravel Forge Site | I&#039;m a crayon"/>
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://imacrayon.com/words/adding-cloudflare-to-a-laravel-forge-site"/>
    <meta property="og:description" content="Work by Christian Taylor. An artist &amp; full stack developer based in Wichita, KS." />

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@ima_crayon">
    <meta name="twitter:creator" content="@ima_crayon">

    
    <link href="https://twitter.com/ima_crayon" rel="me">

    
    <link rel="webmention" href="https://webmention.io/imacrayon.com/webmention" />
    <link rel="pingback" href="https://webmention.io/imacrayon.com/xmlrpc" />

    <link href="/feed.atom" type="application/atom+xml" rel="alternate" title="I&#039;m a crayon Atom Feed">

    <link rel="stylesheet" href="/assets/css/main.css?id=04e600291c4a9453082a11c3f2e48b4b">

    <script src="/assets/js/webmention.js" data-page-url="https://imacrayon.com/pictures/" async></script>
  </head>
  <body class="text-gray-700 font-sans antialiased">
    <header role="banner" class="mt-12">
      <div class="mx-auto px-4 max-w-2xl">
        <a class="sr-only block bg-black text-white text-lg text-center font-medium focus:not-sr-only" href="#main">
          <span class="block p-4">Skip to content</span>
        </a>
        <div class="flex items-center text-sm">
          <a class="text-gray-500 hover:bg-gold-100 hover:text-gold-800" href="/" title="I&#039;m a crayon home">
            I'm a crayon
          </a>
          <div class="flex flex-1 justify-end items-center">
             <nav class="flex items-center justify-end space-x-6">
   <a class="inline-flex items-center hover:bg-gold-100 hover:text-gold-800" href="/pictures">
  Pictures
</a>
 
   <a class="inline-flex items-center hover:bg-gold-100 hover:text-gold-800" href="/about">
  About
</a>
 
</nav>
 
          </div>
        </div>
      </div>
    </header>
    <main id="main">
      <div class="pt-12">
  <article class="mx-auto px-4 max-w-2xl">
    <div class="space-y-2">
      <h1 class="text-2xl sm:text-3xl font-medium break-words">Adding Cloudflare to a Laravel Forge Site</h1>
      <div class="grid sm:grid-cols-2 gap-1">
        <div>
           <time class="block text-gray-500 text-xs uppercase tracking-widest" datetime="2022-02-23T19:15:00+00:00">
  February 23, 2022
</time>
 
        </div>
                  <div class="text-xs uppercase tracking-widest flex justify-end">
            <div>
                              <a href="/words/categories/tooling" class="hover:text-gold-800 focus:text-gold-800 hover:bg-gold-100 focus:bg-gold-100">tooling</a>                          </div>
          </div>
              </div>
    </div>

    <div class="mt-10 prose max-w-full">
      <p>I manage several websites hosted on <a href="https://digitalocean.com">Digital Ocean</a> through <a href="https://forge.laravel.com">Laravel Forge</a>. Recently some unusual traffic on one of these websites prompted me to setup some <a href="https://cloudflare.com">Cloudflare</a> security features. Cloudflare required that I migrate my website's DNS from Digital Ocean onto their platform, and this required some additional tweaks to settings within Laravel Forge and Digital Ocean. I'm going to document my migration process here for future me.</p>

<h2>DNS</h2>

<p>Migrating the DNS settings to Cloudflare is straight forward. Cloudflare is able to scan your domain and pull in all of the existing DNS settings that are already setup on Digital Ocean.</p>

<h2>SSL</h2>

<p>After migrating the DNS, you need to create a new TLS certificate signed by Cloudflare. Without this certificate the Digital Ocean server fails to respond to requests forwarded from Cloudflare. In the Cloudflare dashboard navigate to <strong>SSL/TSL > Origin Server</strong>. From this page you can generate a new certificate for your domain. Once you have a new certificate, head over to Laravel Forge. Navigate to the website's dashboard, then go to the <strong>SSL</strong> page, and click <strong>Install Existing</strong> under the New Certificate panel. Copy and paste the certificate information from Cloudflare into the Private Key and Certificate fields in Forge.</p>

<p>At this point the website should be ready to go. The last step is to add your SSL certificate to any Digital Ocean Spaces CDNs your might have configured.</p>

<h2>Spaces CDN</h2>

<p>On the Settings page for your Digital Ocean Space, select <strong>Edit > Add a new certificate</strong>. Within the settings modal select the <strong>Bring your own certificate</strong> tab. From here you can add your certificate settings just like you did in SSL step above.</p>
    </div>

    <nav class="my-12 border-t border-gray-200 grid sm:grid-cols-2 sm:border-0 sm:gap-8">
              <a class="group border-b border-gray-200 flex hover:bg-gold-50 hover:text-gold-800" href="https://imacrayon.com/words/subdomain-redirects-in-laravel-forge" title="Older Post: Subdomain Redirects in Laravel Forge">
          <span class="flex-shrink-0 flex items-center group-hover:bg-gold-100">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="24" class="h-6 w-6 text-gray-400 group-hover:text-gold-400" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
            </svg>
          </span>
          <span class="flex-1 py-3 px-6 flex items-center justify-end text-right">
            <span class="space-y-1">
              <span class="font-medium">Subdomain Redirects in Laravel Forge</span>
               <time class="block text-gray-500 text-xs uppercase tracking-widest" datetime="2021-02-04T21:28:00+00:00">
  February 4, 2021
</time>
 
            </span>
          </span>
        </a>
                </nav>

    <div id="mentions" class="space-y-8 mb-12">
      <h2 class="text-2xl sm:text-3xl font-medium">Mentions</h2>
              <p class="italic text-gray-500">Nothing.</p>
          </div>
  </article>
</div>
    </main>
    <footer class="mb-12 text-sm flex justify-center">
       <nav class="flex items-center justify-end space-x-6">
   <a class="inline-flex items-center hover:bg-gold-100 hover:text-gold-800" href="/pictures">
  Pictures
</a>
 
   <a class="inline-flex items-center hover:bg-gold-100 hover:text-gold-800" href="/about">
  About
</a>
 
</nav>
 
    </footer>
  </body>
</html>
