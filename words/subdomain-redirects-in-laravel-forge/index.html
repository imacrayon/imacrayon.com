<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="referrer" content="always">
    <link rel="canonical" href="https://imacrayon.com/words/subdomain-redirects-in-laravel-forge">

    <title>Subdomain Redirects in Laravel Forge | I&#039;m a crayon</title>
    <meta name="description" content="How to redirect a subdomain to another domain in Laravel Forge.">

    <link rel="icon" href="/favicon.svg">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#AA8C2C">

    <meta property="og:title" content="Subdomain Redirects in Laravel Forge | I&#039;m a crayon"/>
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://imacrayon.com/words/subdomain-redirects-in-laravel-forge"/>
    <meta property="og:description" content="Work by Christian Taylor. An artist &amp; full stack developer based in Wichita, KS." />

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@ima_crayon">
    <meta name="twitter:creator" content="@ima_crayon">

    
    <link href="https://twitter.com/ima_crayon" rel="me">

    
    <link rel="webmention" href="https://webmention.io/imacrayon.com/webmention" />
    <link rel="pingback" href="https://webmention.io/imacrayon.com/xmlrpc" />

    <link href="/feed.atom" type="application/atom+xml" rel="alternate" title="I&#039;m a crayon Atom Feed">

    <link rel="stylesheet" href="/assets/css/main.css?id=04e600291c4a9453082a11c3f2e48b4b">

    <script src="/assets/js/webmention.js" data-page-url="https://imacrayon.com/pictures/" async></script>
  </head>
  <body class="text-gray-700 font-sans antialiased">
    <header role="banner" class="mt-12">
      <div class="mx-auto px-4 max-w-2xl">
        <a class="sr-only block bg-black text-white text-lg text-center font-medium focus:not-sr-only" href="#main">
          <span class="block p-4">Skip to content</span>
        </a>
        <div class="flex items-center text-sm">
          <a class="text-gray-500 hover:bg-gold-100 hover:text-gold-800" href="/" title="I&#039;m a crayon home">
            I'm a crayon
          </a>
          <div class="flex flex-1 justify-end items-center">
             <nav class="flex items-center justify-end space-x-6">
   <a class="inline-flex items-center hover:bg-gold-100 hover:text-gold-800" href="/pictures">
  Pictures
</a>
 
   <a class="inline-flex items-center hover:bg-gold-100 hover:text-gold-800" href="/about">
  About
</a>
 
</nav>
 
          </div>
        </div>
      </div>
    </header>
    <main id="main">
      <div class="pt-12">
  <article class="mx-auto px-4 max-w-2xl">
    <div class="space-y-2">
      <h1 class="text-2xl sm:text-3xl font-medium break-words">Subdomain Redirects in Laravel Forge</h1>
      <div class="grid sm:grid-cols-2 gap-1">
        <div>
           <time class="block text-gray-500 text-xs uppercase tracking-widest" datetime="2021-02-04T21:28:00+00:00">
  February 4, 2021
</time>
 
        </div>
                  <div class="text-xs uppercase tracking-widest flex justify-end">
            <div>
                              <a href="/words/categories/tooling" class="hover:text-gold-800 focus:text-gold-800 hover:bg-gold-100 focus:bg-gold-100">tooling</a>                          </div>
          </div>
              </div>
    </div>

    <div class="mt-10 prose max-w-full">
      <p>I had to go through some trial and error to get this working so I'm writing it down. My goal was to permanently redirect a domain like <code>beta.imacrayon.com</code> to <code>imacrayon.com</code> in Laravel Forge.</p>

<p>In order to properly redirect <code>https://beta.imacrayon.com</code>. I generated a new LetsEncrypt certificate with the following domains: <code>imacrayon.com,www.imacrayon.com,beta.imacrayon.com</code>.</p>

<p>Next I added two new server blocks to the top of my nginx config:</p>

<pre><code class="language-bash">server {
    listen 80;
    listen [::]:80;
    server_name beta.imacrayon.com;
    return 301 https://imacrayon.com$request_uri;
}

server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;

    # PASTE YOUR SSL DIRECTIVES HERE

    server_name beta.imacrayon.com;
    return 301 https://imacrayon.com$request_uri;
}
</code></pre>

<p>The second server block requires you to add the SSL directives for the LetsEncrypt certificate generated in the first step. You should be able to find these directives inside your existing nginx config. They’ll probably be labeled with a comment like <code># FORGE SSL (DO NOT REMOVE!)</code> and look like this:</p>

<pre><code class="language-bash">    # FORGE SSL (DO NOT REMOVE!)
    ssl_certificate /etc/nginx/ssl/imacrayon.com/xxx/server.crt;
    ssl_certificate_key /etc/nginx/ssl/imacrayon.com/xxx/server.key;

    ssl_protocols TLSv1.2;
    ssl_ciphers …
    ssl_prefer_server_ciphers on;
    ssl_dhparam /etc/nginx/dhparams.pem;
</code></pre>

<p>That’s it! After saving your config <code>http://beta.imacrayon.com</code> and <code>https://beta.imacrayon.com</code> should now redirect to <code>https://imacrayon.com</code>.</p>

<p>Browsers will cache 301 redirects. So when testing these new redirects you may need to enable the “Clear cache” option in your browser's Developer Tools, it’s usually located under the “Network” tab.</p>
    </div>

    <nav class="my-12 border-t border-gray-200 grid sm:grid-cols-2 sm:border-0 sm:gap-8">
              <a class="group border-b border-gray-200 flex hover:bg-gold-50 hover:text-gold-800" href="https://imacrayon.com/words/mlk-day" title="Older Post: MLK Day">
          <span class="flex-shrink-0 flex items-center group-hover:bg-gold-100">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="24" class="h-6 w-6 text-gray-400 group-hover:text-gold-400" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
            </svg>
          </span>
          <span class="flex-1 py-3 px-6 flex items-center justify-end text-right">
            <span class="space-y-1">
              <span class="font-medium">MLK Day</span>
               <time class="block text-gray-500 text-xs uppercase tracking-widest" datetime="2021-01-18T09:18:00+00:00">
  January 18, 2021
</time>
 
            </span>
          </span>
        </a>
                    <a class="group border-b border-gray-200 flex hover:bg-gold-50 hover:text-gold-800" href="https://imacrayon.com/words/adding-cloudflare-to-a-laravel-forge-site" title="Newer Post: Adding Cloudflare to a Laravel Forge Site">
          <span class="flex-1 py-3 px-6 flex items-center">
            <span class="space-y-1">
              <span class="font-medium">Adding Cloudflare to a Laravel Forge Site</span>
               <time class="block text-gray-500 text-xs uppercase tracking-widest" datetime="2022-02-23T19:15:00+00:00">
  February 23, 2022
</time>
 
            </span>
          </span>
          <span class="flex-shrink-0 flex items-center group-hover:bg-gold-100">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="24" class="h-6 w-6 text-gray-400 group-hover:text-gold-400" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </span>
        </a>
          </nav>

    <div id="mentions" class="space-y-8 mb-12">
      <h2 class="text-2xl sm:text-3xl font-medium">Mentions</h2>
              <p class="italic text-gray-500">Nothing.</p>
          </div>
  </article>
</div>
    </main>
    <footer class="mb-12 text-sm flex justify-center">
       <nav class="flex items-center justify-end space-x-6">
   <a class="inline-flex items-center hover:bg-gold-100 hover:text-gold-800" href="/pictures">
  Pictures
</a>
 
   <a class="inline-flex items-center hover:bg-gold-100 hover:text-gold-800" href="/about">
  About
</a>
 
</nav>
 
    </footer>
  </body>
</html>
